<html>

  <head>
    <script>
      var html = js = css = ""
      window.onload = x => {
        [1, 2, 3].forEach(filetype => {
          document.getElementById('input-file-' + filetype).addEventListener('change', getFile);
        })
      }

      function getFile(event) {
        const input = event.target
        if ('files' in input && input.files.length > 0) {
          readFileContent(input.files[0]).then(setVariable)
        }
      }

      function setVariable(content) {
        if (content.startsWith("<!-- html -->")) {
          html = content;
        }
        if (content.startsWith("// js")) {
          js = content;
        }
        if (content.startsWith("/* css */")) {
          css = content;
        }
        if (html != '' && js != '' && css != '') {
          document.getElementById('result').value = html.replace(/\<link rel=[\'\"]stylesheet[\'\"] href=[^\>]+\>/i, "<style>\n" + css + "\n</style\>").replace(/\<script src=[\"\']\w+\.js[\"\']\>\<\/script\>/i, "\<script>\n" + js + "\n\</script\>");
        }
      }

      function readFileContent(file) {
        const reader = new FileReader()
        return new Promise((resolve, reject) => {
          reader.onload = event => resolve(event.target.result)
          reader.onerror = error => reject(error)
          reader.readAsText(file)
        });
      }
    </script>
  </head>

  <body>
    <input type="file" id="1"><br>
    <input type="file" id="2"><br>
    <input type="file" id="3"><br>

    <textarea id="result"></textarea>
  </body>

</html>
